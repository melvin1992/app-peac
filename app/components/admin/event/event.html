<div ng-include='"../components/admin/shared/header.html"'></div>

<div class="container main-container">

    <div class="row">
        <div class="col-lg-12">
            <h1 class="page-header"><i class="fa fa-calendar"></i> Events</h1>
            <ol class="breadcrumb">
                <li><a href="#/admin">Home</a></li>
                <li class="active">Events</li>
            </ol>
        </div>
    </div>

    <div class="row">
      <div class="container">
        <div class="col-lg-2">
          <div class="row">
              <div ng-include='"../components/admin/shared/sidebar.html"'></div>
          </div>
        </div>
        <div class="col-lg-10">
          <div class="alert alert-success" ng-show="success">
            <strong>Success!</strong> {{success}}
          </div>
          <div class="alert alert-danger" ng-show="err">
            <strong>Error!</strong> {{err}}
          </div>

          <div class="row ten-margin">
            <div class="col-sm-6">
              <div class="row">
                Year:
                <b ng-show="!searchYear">{{activeYear}}</b>
                <b ng-show="searchYear">{{searchYear}}</b>
                | Event Year:
                <select ng-model="searchYear" ng-options="year for year in years" ng-change="showEventPerYear(searchYear)">
                  <option value="">Year</option>
                </select>
              </div>
            </div>
            <div class="col-sm-6">
              <button type="button" class="btn btn-sm btn-primary pull-right" data-toggle="modal" data-target="#openModal" ng-click="clearEventData()"><i class="fa fa-plus"/> Add Event</button>
            </div>
          </div>

          <div class="row">
            <div class="col-sm-12">
              <div class="table-participants">
                <table class="table table-hover">
                  <thead>
                    <tr>
                      <th>Year</th>
                      <th>Event Name</th>
                      <th>Event Type</th>
                      <th width="80px">Date</th>
                      <th>Venue</th>
                      <th>Fee</th>
                      <th>Status</th>
                      <th width="130px">Actions</th>
                    </tr>
                  </thead>
                  <tbody>
                     <tr ng-repeat="event in eventList">
                       <td>{{event.eventYear}}</td>
                       <td>{{event.name}}</td>
                       <td>{{event.eventType}}</td>
                       <td>{{event.eventDate}}</td>
                       <td>{{event.venue}}</td>
                       <td>{{event.eventFee}}</td>
                       <td>{{event.status}}</td>
                       <td>
                         <button type="button" class="btn btn-xs btn-success" data-toggle="modal" data-target="#openModal" ng-click="editEvent(event)"><i class="fa fa-pencil"/> Edit</button>
                         <button type="button" class="btn btn-xs btn-danger" data-toggle="modal" data-target="#deleteModal" ng-click="showNotif(event)"><i class="fa fa-trash"/> Delete</button>
                       </td>
                     </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>


        </div>
      </div>
    </div>

</div>
<!-- /.container -->
<div class="modal fade" id="deleteModal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h3 class="modal-title"><i class="fa fa-warning"/> Are you sure you want to delete the record?</h3>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-danger" ng-click="deleteEvent(eventData._id)"><i class="fa fa-check"/> YES</button>
        <button type="button" class="btn btn-primary" data-dismiss="modal"><i class="fa fa-times"/> NO</button>
      </div>
    </div>
  </div>
</div>


<div class="modal fade" id="openModal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h3 class="modal-title"><i class="fa fa-calendar"/> Event Information</h3>
      </div>
      <div class="modal-body">
        <div class="alert alert-success" ng-show="eventSuccess">
          <strong>Success!</strong> {{eventSuccess}}
        </div>
        <div class="alert alert-danger" ng-show="eventErr">
          <strong>Error!</strong> {{eventErr}}
        </div>

        <form class="form-horizontal" role="form" name="eventForm">
          <div class="form-group">
            <label class="col-sm-4 control-label" for="textinput">Name</label>
            <div class="col-sm-7">
              <input type="text" placeholder="Event Name" class="form-control" ng-model="eventData.name" name="name" required>
            </div>
            <span class="required-field" ng-show="eventForm.name.$error.required">*</span>
          </div>
          <div class="form-group">
            <label class="col-sm-4 control-label" for="textinput">Year</label>
            <div class="col-sm-7">
              <select class="form-control input-md" ng-model="eventData.eventYear" ng-options="year for year in years" name="year" required>
                <option value="">Select year</option>
              </select>
            </div>
            <span class="required-field" ng-show="eventForm.year.$error.required">*</span>
          </div>
          <div class="form-group">
            <label class="col-sm-4 control-label" for="textinput">Type</label>
            <div class="col-sm-7">
              <select class="form-control input-md" ng-model="eventData.eventType" ng-options="type for type in eventType" name="type" required>
                <option value="">Select type</option>
              </select>
            </div>
            <span class="required-field" ng-show="eventForm.type.$error.required">*</span>
          </div>
          <div class="form-group">
            <label class="col-sm-4 control-label" for="textinput">Date Description</label>
            <div class="col-sm-7">
              <input type="text" placeholder="Date" class="form-control" ng-model="eventData.eventDate" name="date" required>
            </div>
            <span class="required-field" ng-show="eventForm.date.$error.required">*</span>
          </div>
          <div class="form-group">
            <label class="col-sm-4 control-label" for="textinput">Venue</label>
            <div class="col-sm-7">
              <input type.value as type="text" placeholder="Event Venue" class="form-control" ng-model="eventData.venue" name="venue" required>
            </div>
            <span class="required-field" ng-show="eventForm.venue.$error.required">*</span>
          </div>
          <div class="form-group">
            <label class="col-sm-4 control-label" for="textinput">Fee</label>
            <div class="col-sm-7">
              <input type="number" placeholder="Event Fee" class="form-control" ng-model="eventData.eventFee" name="fee" required>
            </div>
            <span class="required-field" ng-show="eventForm.fee.$error.required">*</span>
          </div>
          <div class="form-group">
            <label class="col-sm-4 control-label" for="textinput">Max Participants</label>
            <div class="col-sm-7">
              <input type="number" placeholder="Max Participants" class="form-control" ng-model="eventData.limits" name="limits" required>
            </div>
            <span class="required-field" ng-show="eventForm.limits.$error.required">*</span>
          </div>
          <div class="form-group">
            <label class="col-sm-4 control-label" for="textinput">Event Hours</label>
            <div class="col-sm-7">
              <input type="number" placeholder="Event Hours" class="form-control" ng-model="eventData.hours">
            </div>
          </div>
          <div class="form-group">
            <label class="col-sm-4 control-label" for="textinput">Region</label>
            <div class="col-sm-7">
              <select class="form-control input-md" ng-model="eventData.region" ng-options="r.name for r in regionList track by r.code" multiple name="region" required>
              </select>
            </div>
            <span class="required-field" ng-show="eventForm.region.$error.required">*</span>
          </div>
          <div class="form-group">
            <label class="col-sm-4 control-label" for="textinput">Province</label>
            <div class="col-sm-7">
              <select class="form-control input-md" ng-model="eventData.province" ng-options="p.name for p in provinceList track by p.code" multiple>
              </select>
            </div>
          </div>
          <div class="form-group">
            <label class="col-sm-4 control-label" for="textinput">Deadline</label>
            <div id="datepicker" class="col-sm-7">
              <input type="text" class="form-control" placeholder="Deadline" ng-model="eventData.deadline" name="deadline" required>
            </div>
            <span class="required-field" ng-show="eventForm.deadline.$error.required">*</span>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary" ng-click="saveEvent(eventData)"><i class="fa fa-check"/> Submit</button>
      </div>
    </div>
  </div>
</div>


<script>
$(function(){
  $('#datepicker input').datepicker({
      autoclose: true
  });
});
</script>
